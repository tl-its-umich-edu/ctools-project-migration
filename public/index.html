<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Project Site Migration</title>
  <link rel="stylesheet" href="vendors/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="css/custom.css">
</head>

<body ng-app="projectMigrationApp">
    <nav role="navigation" class="navbar navbar-default" style="background:#00274c">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header mastHead">
          <button data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
          </button>
          <h1 class="navbar-brand collapse-nav" style="margin:0;color:#fff">Project Site Migration</h1>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
              <li>
                  <a id="helpLink" class="collapse-nav" href="http://its.umich.edu/projects/ctools-project-sites/training-resources/migration-tool-help" style="color:#fff" target="_blank">Migration Tool Help</a>
              </li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>
  <div ng-controller="projectMigrationController" class="container-fluid" style="padding:0 20px">
    <div role="alert" class="sr-only alert alert-info" ng-show="migratingProjects.length !== 0 && activeMigrations" >Current migrations: {{migratingProjects.length}}</div>
    <div role="alert" class="sr-only alert alert-success" ng-show="migratingProjects.length === 0 && activeMigrations">All migrations are finished.</div>
    <div class="row">
      <div class="col-md-6 col-lg-6 col-sm-6 col-xs-12">
      </div>
      <div class="col-md-6 col-lg-6 col-sm-6 col-xs-12 topMenu">
          <a ng-show="!boxAuthorized" class="btn btn-primary" href="" data-toggle="modal" data-target="#boxAuthModal">Authorize App to Box</a>
          <a ng-show="boxAuthorized" class="btn btn-primary" href="" data-toggle="modal" data-target="#boxLogoutModal">Unauthorize App from Box</a>
      </div>
    </div>  
    <div class="row">
      <div class="col-md-4 col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title" id="projectPanelHeader">CTools Sites</h3></div>
          <div class="panel-body" aria-labelledby="projectPanelHeader">
            <div ng-include="'views/projects-source.html'">
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-lg-4">
        <div class="panel panel-default"> 
          <div class="panel-heading">
            <h3 class="panel-title" id="migratingPanelHeader">In Progress
              <small class="hidden-sm hidden-xs" ng-if="status.migrations">Updated: {{status.migrations}}</small>
              <span class="badge pull-right" ng-if="!migratingProjectsError">{{migratingProjects.length}}</span>
            </h3>
          </div>
          <div class="panel-body" aria-labelledby="migratingPanelHeader">
            <div ng-include="'views/projects-migrating.html'">
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-lg-4">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title" id="migratedPanelHeader">Completed  <small class="hidden-sm hidden-xs" ng-if="status.migrated">Updated: {{status.migrated}}</small> <span class="badge pull-right"  ng-if="!migratedProjectsError">{{migratedProjects.length}}</span></h3>
          </div>
          <div class="panel-body" aria-labelledby="migratedPanelHeader">
            <div ng-include="'views/projects-migrated.html'">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div ng-controller="projectMigrationControllerStatus">
    <a  aria-hidden="true" data-target="#statusModal" data-toggle="modal" href="" class="statusButton" ng-click="getStatus()"> <span class="sr-only">Status of application</span></a>
    <div class="modal fade" id="statusModal" tabindex="-1" role="dialog" aria-labelledby="statusModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="statusModalLabel">Status</h4>
          </div>
          <div class="modal-body">
            <div class="container">
              <table class="table table-striped table-condensed table-hover" style="width:auto">
                <thead>
                  <tr> <th scope="col">Key</th><th scope="col">Value</th></tr>
                </thead>
                <tbody>
                  <tr ng-repeat="(key, value) in server_status.urls">
                    <td> {{key}} </td> <td> {{ value }} </td>
                  </tr>
                  <tr ng-repeat="(key, value) in server_status.build">
                    <td> {{key}} </td> <td> {{ value }} </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>  
          <div class="modal-footer">
            <button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>


    
  
    <div id="blockerModal" class="modal fade" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="blockerModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="blockerModalLabel">Working so hard...</h4>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="progress"  style="width: 540px">
                <div class="progress-bar progress-bar-info progress-bar-striped active" style="width: 100%">
                </div>
              </div>
            </div>
          </div>  
        </div>
      </div>
    </div>



  <script type="text/javascript" src="vendors/jquery/jquery-1.11.0.min.js"></script>
  <script src="vendors/bootstrap/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="vendors/angular/angular.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="vendors/angular/angular-animate.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="vendors/underscore/underscore-min.js" type="text/javascript" charset="utf-8"></script>
  <script src="vendors/moment/moment.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/app.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/controllers.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/factories.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/filters.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/utils.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>
