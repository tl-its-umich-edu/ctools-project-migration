<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Project Site Migration</title>
<link rel="stylesheet" href="vendors/bootstrap/bootstrap.min.css">
<link rel="stylesheet" href="css/custom.css">
</head>

<body ng-app="projectMigrationApp">

	<div ng-controller="projectMigrationController">
  	<nav role="navigation" class="navbar navbar-default"
			style="background: #00274c">
			<div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header mastHead">
					<button data-target="#bs-example-navbar-collapse-1"
						data-toggle="collapse" class="navbar-toggle collapsed"
						type="button">
						<span class="sr-only">Toggle navigation</span> <span
							class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<h1 class="navbar-brand collapse-nav" style="margin: 0; color: #fff">Project
						Site Migration</h1>
				</div>
				<!-- Collect the nav links, forms, and other content for toggling -->
				<div id="bs-example-navbar-collapse-1"
					class="collapse navbar-collapse">
					<ul class="nav navbar-nav navbar-right">
						<li>
							<a class=""
								ng-if="isAdminUser"
								class=""
								href="batch.html"
								style="color: #fff">Batch</a>
						</li>
						<li>
							<a class="btn btn-md btn-primary" id="helpLink"
								class="collapse-nav"
								href="http://its.umich.edu/projects/ctools-project-sites/training-resources/migration-tool-help"
								style="color: #fff" target="_blank">Migration Tool Help</a>
						</li>
					</ul>
				</div>
				<!-- /.navbar-collapse -->
			</div>
		</nav>

    <div id="sserve-lite"></div>
    <div class="container-fluid">
  		<div role="alert" class="sr-only alert alert-info"
  			ng-show="migratingProjects.length !== 0 && activeMigrations">Current
  			migrations: {{migratingProjects.length}}</div>
  		<div role="alert" class="sr-only alert alert-success"
  			ng-show="migratingProjects.length === 0 && activeMigrations">All
  			migrations are finished.</div>
  		<div class="row">
  			<div class="col-md-6 col-lg-6 col-sm-6 col-xs-12">
  				<p>
  					Before migrating your sites, please review the <a
  						href="http://its.umich.edu/projects/ctools-project-sites/?q=node/42"
  						"email me" target="_blank">Pre-Migration Checklist.</a>
  				</p>
  			</div>
  			<div class="col-md-6 col-lg-6 col-sm-6 col-xs-12 topMenu">
  			</div>
  		</div>
  		<div class="row">
  			<div class="col-md-6 col-lg-6">
  				<div class="panel panel-default">
  					<div class="panel-heading">
  						<h3 class="panel-title" id="projectPanelHeader">CTools Sites</h3>
  					</div>
  					<div class="panel-body" aria-labelledby="projectPanelHeader">
  						<div ng-include="'views/projects-source-lite.html'"></div>
  					</div>
  				</div>
  			</div>

  			<div class="col-md-6 col-lg-6">
  				<div class="panel panel-default">
  					<div class="panel-heading">
  						<h3 class="panel-title" id="migratedPanelHeader">
  							Completed <small class="hidden-sm hidden-xs"
  								ng-if="status.migrated">Updated: {{status.migrated}}</small> <span
  								class="badge pull-right" ng-if="!migratedProjectsError">{{migratedProjects.length}}</span>
  						</h3>
  					</div>
  					<div class="panel-body" aria-labelledby="migratedPanelHeader">
  						<div ng-include="'views/projects-migrated.html'"></div>
  					</div>
  				</div>
  			</div>
  		</div>
  </div>

  <div class="modal fade" id="reportModal" tabindex="-1" role="dialog"
    aria-labelledby="reportModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"
            aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title" id="reportModalLabel">Site Migration Report</h4>
        </div>
        <div class="modal-body">
          <div class="container">
            <div class="row" style="width:535px">
              <div class="col-md-6 col-lg-6 col-sm-6 col-xs-16">
                <h3>{{reportDetails.title}}. <small>Items exported: {{reportDetails.data.items.length}}</small></h3>
              </div>
              <div class="col-md-6 col-lg-6 col-sm-6 col-xs-16" style="text-align:right">
                <button ng-show="!showPaths" class="btn btn-default" type="button" ng-click="showPaths = !showPaths">Show paths</button>
                <button ng-show="showPaths" class="btn btn-default" type="button" ng-click="showPaths = !showPaths">Hide paths</button>
              </div>
            </div>
            <br>
            <div style="width:535px" ng-class="reportDetails.data.counts.successes.length ? 'alert alert-info' : 'alert alert-warning'">
              {{reportDetails.status}} - successes: {{reportDetails.data.counts.successes}}, errors: {{reportDetails.data.counts.failures}}
              <p ng-show="reportDetails.data.counts.failures !== 0">
                <br>
                <a href="https://its.umich.edu/projects/ctools-project-sites/?q=node/43#" target="_blank">See documentation for assistance on specific errors.</a>
              </p>
            </div>
            <ul class="list-group container"  style="width:550px;margin:0">
              <li class="list-group-item" ng-repeat="item in reportDetails.data.items">
                <div class="row">
                  <div class="col-md-10 col-lg-10 col-sm-10 col-xs-10" style="vertical-align: middle">
                    <span class="file-icon {{item.file_name | getExtension}}" style="vertical-align: middle;"></span>
                    <span ng-show="showPaths" style="vertical-align: middle;">{{item.path}}</span>
                    <span ng-hide="showPaths" style="vertical-align: middle;">{{item.file_name}}</span>
                  </div>
                  <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2" style="text-align:right">
                    <span ng-show="item.status_code==='success'" class="glyphicon glyphicon-ok" aria-hidden="true" style="vertical-align: middle"></span>
                    <span ng-show="item.status_code==='fail'" class="glyphicon glyphicon-info-sign" aria-hidden="true" style="vertical-align: middle;color:#c00"></span>
                  </div>
                </div>
                <div class="row" ng-show="item.status.indexOf('success') === -1 && item.status.indexOf('created') === -1">
                  <div class="col-md-10 col-lg-10 col-sm-10 col-xs-10" style="vertical-align: middle;padding-left:50px">
                  <small>{{item.status}}</small>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
    <div class="modal fade" id="reportModal" tabindex="-1" role="dialog"
			aria-labelledby="reportModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="reportModalLabel">Site Migration Report</h4>
					</div>
					<div class="modal-body">
						<div class="container">
              <div class="row" style="width:535px">
                <div class="col-md-6 col-lg-6 col-sm-6 col-xs-16">
                  <h3>{{reportDetails.title}}. <small>Items exported: {{reportDetails.data.items.length}}</small></h3>
                </div>
                <div class="col-md-6 col-lg-6 col-sm-6 col-xs-16" style="text-align:right">
                  <button ng-show="!showPaths" class="btn btn-default" type="button" ng-click="showPaths = !showPaths">Show paths</button>
                  <button ng-show="showPaths" class="btn btn-default" type="button" ng-click="showPaths = !showPaths">Hide paths</button>
                </div>
              </div>
              <br>
              <div style="width:535px" ng-class="reportDetails.data.counts.successes.length ? 'alert alert-info' : 'alert alert-warning'">
                {{reportDetails.status}} - successes: {{reportDetails.data.counts.successes}}, errors: {{reportDetails.data.counts.failures}}
                <p ng-show="reportDetails.data.counts.failures !== 0">
                  <br>
                  <a href="https://its.umich.edu/projects/ctools-project-sites/?q=node/43#" target="_blank">See documentation for assistance on specific errors.</a>
                </p>
              </div>
              <ul class="list-group container"  style="width:550px;margin:0">
                <li class="list-group-item" ng-repeat="item in reportDetails.data.items">
                  <div class="row">
                    <div class="col-md-10 col-lg-10 col-sm-10 col-xs-10" style="vertical-align: middle">
                      <span class="file-icon {{item.file_name | getExtension}}" style="vertical-align: middle;"></span>
                      <span ng-show="showPaths" style="vertical-align: middle;">{{item.path}}</span>
                      <span ng-hide="showPaths" style="vertical-align: middle;">{{item.file_name}}</span>
                    </div>
                    <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2" style="text-align:right">
                      <span ng-show="item.status_code==='success'" class="glyphicon glyphicon-ok" aria-hidden="true" style="vertical-align: middle"></span>
                      <span ng-show="item.status_code==='fail'" class="glyphicon glyphicon-info-sign" aria-hidden="true" style="vertical-align: middle;color:#c00"></span>
                    </div>
                  </div>
                  <div class="row" ng-show="item.status.indexOf('success') === -1 && item.status.indexOf('created') === -1">
                    <div class="col-md-10 col-lg-10 col-sm-10 col-xs-10" style="vertical-align: middle;padding-left:50px">
                    <small>{{item.status}}</small>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>


  </div>



  <div ng-controller="projectMigrationControllerStatus">
    <a aria-hidden="true" data-target="#statusModal" data-toggle="modal"
      href="" class="statusButton" ng-click="getStatus()"> <span
      class="sr-only">Status of application</span></a>
    <div class="modal fade" id="statusModal" tabindex="-1" role="dialog"
      aria-labelledby="statusModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"
              aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title" id="statusModalLabel">Status</h4>
          </div>
          <div class="modal-body">
            <div class="container">
              <table class="table table-striped table-condensed table-hover"
                style="width: auto">
                <thead>
                  <tr>
                    <th scope="col">Key</th>
                    <th scope="col">Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="(key, value) in server_status.urls">
                    <td>{{key}}</td>
                    <td>{{ value }}</td>
                  </tr>
                  <tr ng-repeat="(key, value) in server_status.build">
                    <td>{{key}}</td>
                    <td>{{ value }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

	<script type="text/javascript"
		src="vendors/jquery/jquery-1.11.0.min.js"></script>
	<script src="vendors/bootstrap/bootstrap.min.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="vendors/angular/angular.min.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="vendors/angular/angular-animate.min.js"
		type="text/javascript" charset="utf-8"></script>
	<script src="vendors/underscore/underscore-min.js"
		type="text/javascript" charset="utf-8"></script>
	<script src="vendors/moment/moment.min.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="js/sserve/app.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/sserve/controllers.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/sserve/factories.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/filters.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/utils.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>
